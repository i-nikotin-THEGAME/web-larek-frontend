# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Данные и типы данных используемые в приложении

Интерфейс для карирчки товара
```
export interface IItems {
    id: string;
    description: string;
    image: string;
    title: string;
    category: string;
    price: number
}
```
Интерфейс для заказа при добавлении товара в корзину

```
export interface IOrder {
    payment: string;
    email: string;
    phone: string;
    address: string;
    total: number;
    items: IItems[]
}
```
Данные товара испльзуемые для отображение в корзине

```
export type TBasketList = Pick<IItems, 'title' | 'price'>
```
Данные для выбора способа оплаты и адреса доставки

```
export type TOrderPayment = Pick<IOrder, 'payment' | 'address'>
```

Данные контактов пользователя для оформления заказа

```
export type TOrderContacts = Pick<IOrder, 'email' | 'phone'>
```

## Архитектура приложения

Код приложения разделен на слои гласно парадигме MVP:
- слой представления, отвечате за представление данных на странице,
- слой данных, отвечате за хранение и изменение данных,
- презентер, отвечате за связи представления и данные.

### Базовый код

#### Класс `Api`
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы:
- `get` - выполняет `GET` запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер,
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на эндпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс `EventEmitter`
Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков о наступлении события.
Класс имеет методы:
- `on` — для подписки на событие,
- `off` — для отписки от события,
- `emit` — уведомления подписчиков о наступлении события.

Дополнительно реализованы методы:
- `onAll` —  для подписки на все события,
- `offAll` —  для сброса всех подписчиков.

Дополнительно есть метод `trigger` , генерирующий заданное событие с заданными
аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса `EventEmitter`.

### Слой данных

Класс `ItemList` отвечает за хранение данных о товаре.\
Конструктор класса принимает инстанс сброкера событий.\
В полях класса хранятся следующие данные:


Класс `OrderList` отвечает за данные о товаре находящие в приложении.

### Слой представления

Все классы представления отвечают за отображение вутри контейнера (DOM-екмент) переданных в них данных.

#### Класс `Modal`





### Слой коммуникации

#### Класс AppApi
Принимает в конструктор экземпляр класса Api и предоставляет методы реализующие взаимодействие с бэкендом сервиса.

## Взаимодействие компонентов
Код, описывающий взаимодействие представления и данных между собой находится в файле `index.ts`, выполняющем роль презентера.\
Взаимодействие осуществляется за счет событий генерируемых с помощью брокера событий и обработчиков этих событий, описанных в `index.ts`\
В `index.ts` сначала создаются экземпляры всех необходимых классов, а затем настраивается обработка событий.

*Список всех событий, которые могут генерироваться в системе:*\
*События изменения данных (генерируются классами моделями данных)*

- `cards:changed` - изменение массива карточек,
- `card-basket:changed` - изменение массива списка товара в корзине,
- `initial:clearSet` - необходима очистка данных во всех формах и модальных окнах.

*События, возникающие при взаимодействии пользователя с интерфейсом (генерируются классами, отвечающими за представление)*

События открытия модальных окон:
- `card-preview:open` - открытие модального окна просмотра информации о товаре,
- `basket:open` - открытие модального окна просмотра корзины,
- `order:open` - открытие модального окна с формой оформления заказа: выбор способа оплаты и указание адреса доставки,
- `contacts:open` - открытие модального окна с формой оформления заказа: ввод электронной почты и ввод номера телефона,
- `success:open` - открытие модального окна с оповещением об успешном оформлении заказа.

События внутри модальных окон:
- `card-preview:select` - выбор товара для отображения в модальном окне,
- `card-preview:submit` - подтверждение выбора товара для добавления в корзину,
- `basket:delete` - удаление товара из корзины,
- `basket:submit` - подтверждение заверешения выбора товара и переход к оформлению заказа,
- `order-payment:checked` - выбор способа оплаты card или cash,
- `order:input` - изменение данных в форме выбора способа оплаты и ввода адреса доставки,
- `order:submit` - подтверждение заверешения ввода данных в форме выбора способа оплаты и ввода адреса доставки и перехода к следующей форме,
- `contacts:input` - изменение данных в форме ввода электронной почты и телефона,
- `contacts:submit` - подтверждение заверешения ввода данных в форме ввода электронной почты и телефона и перехода к оплате.

События валидации:
- `order:validation` - событие, сообщающее о необходимости валидации формы выбора способа оплаты и ввода адреса доставки,
- `contacts:validation` - событие, сообщающее о необходимости валидации формы ввода электронной почты и телефона.